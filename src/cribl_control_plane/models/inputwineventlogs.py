"""Code generated by Speakeasy (https://speakeasy.com). DO NOT EDIT."""

from __future__ import annotations
from .connectionstype import ConnectionsType, ConnectionsTypeTypedDict
from .metadata1type import Metadata1Type, Metadata1TypeTypedDict
from .pqtype import PqType, PqTypeTypedDict
from cribl_control_plane import models, utils
from cribl_control_plane.types import BaseModel
from cribl_control_plane.utils import validate_open_enum
from enum import Enum
import pydantic
from pydantic import field_serializer
from pydantic.functional_validators import PlainValidator
from typing import List, Optional, Union
from typing_extensions import Annotated, NotRequired, TypeAliasType, TypedDict


class InputWinEventLogsType6(str, Enum):
    WIN_EVENT_LOGS = "win_event_logs"


class ReadMode6(str, Enum, metaclass=utils.OpenEnumMeta):
    r"""Read all stored and future event logs, or only future events"""

    # Entire log
    OLDEST = "oldest"
    # From last entry
    NEWEST = "newest"


class EventFormat6(str, Enum, metaclass=utils.OpenEnumMeta):
    r"""Format of individual events"""

    # JSON
    JSON = "json"
    # XML
    XML = "xml"


class InputWinEventLogsWinEventLogs6TypedDict(TypedDict):
    type: InputWinEventLogsType6
    log_names: List[str]
    r"""Enter the event logs to collect. Run \"Get-WinEvent -ListLog *\" in PowerShell to see the available logs."""
    disable_native_module: NotRequired[bool]
    r"""Enable to use built-in tools (PowerShell for JSON, wevtutil for XML) to collect event logs instead of native API (default) [Learn more](https://docs.cribl.io/edge/sources-windows-event-logs/#advanced-settings)"""
    id: NotRequired[str]
    r"""Unique ID for this input"""
    disabled: NotRequired[bool]
    pipeline: NotRequired[str]
    r"""Pipeline to process data from this Source before sending it through the Routes"""
    send_to_routes: NotRequired[bool]
    r"""Select whether to send data to Routes, or directly to Destinations."""
    environment: NotRequired[str]
    r"""Optionally, enable this config only on a specified Git branch. If empty, will be enabled everywhere."""
    pq_enabled: NotRequired[bool]
    r"""Use a disk queue to minimize data loss when connected services block. See [Cribl Docs](https://docs.cribl.io/stream/persistent-queues) for PQ defaults (Cribl-managed Cloud Workers) and configuration options (on-prem and hybrid Workers)."""
    streamtags: NotRequired[List[str]]
    r"""Tags for filtering and grouping in @{product}"""
    connections: NotRequired[List[ConnectionsTypeTypedDict]]
    r"""Direct connections to Destinations, and optionally via a Pipeline or a Pack"""
    pq: NotRequired[PqTypeTypedDict]
    read_mode: NotRequired[ReadMode6]
    r"""Read all stored and future event logs, or only future events"""
    event_format: NotRequired[EventFormat6]
    r"""Format of individual events"""
    interval: NotRequired[float]
    r"""Time, in seconds, between checking for new entries (Applicable for pre-4.8.0 nodes that use Windows Tools)"""
    batch_size: NotRequired[float]
    r"""The maximum number of events to read in one polling interval. A batch size higher than 500 can cause delays when pulling from multiple event logs. (Applicable for pre-4.8.0 nodes that use Windows Tools)"""
    metadata: NotRequired[List[Metadata1TypeTypedDict]]
    r"""Fields to add to events from this input"""
    max_event_bytes: NotRequired[float]
    r"""The maximum number of bytes in an event before it is flushed to the pipelines"""
    description: NotRequired[str]
    disable_json_rendering: NotRequired[bool]
    r"""Enable/disable the rendering of localized event message strings (Applicable for 4.8.0 nodes and newer that use the Native API)"""
    disable_xml_rendering: NotRequired[bool]
    r"""Enable/disable the rendering of localized event message strings (Applicable for 4.8.0 nodes and newer that use the Native API)"""


class InputWinEventLogsWinEventLogs6(BaseModel):
    type: InputWinEventLogsType6

    log_names: Annotated[List[str], pydantic.Field(alias="logNames")]
    r"""Enter the event logs to collect. Run \"Get-WinEvent -ListLog *\" in PowerShell to see the available logs."""

    disable_native_module: Annotated[
        Optional[bool], pydantic.Field(alias="disableNativeModule")
    ] = False
    r"""Enable to use built-in tools (PowerShell for JSON, wevtutil for XML) to collect event logs instead of native API (default) [Learn more](https://docs.cribl.io/edge/sources-windows-event-logs/#advanced-settings)"""

    id: Optional[str] = None
    r"""Unique ID for this input"""

    disabled: Optional[bool] = False

    pipeline: Optional[str] = None
    r"""Pipeline to process data from this Source before sending it through the Routes"""

    send_to_routes: Annotated[Optional[bool], pydantic.Field(alias="sendToRoutes")] = (
        True
    )
    r"""Select whether to send data to Routes, or directly to Destinations."""

    environment: Optional[str] = None
    r"""Optionally, enable this config only on a specified Git branch. If empty, will be enabled everywhere."""

    pq_enabled: Annotated[Optional[bool], pydantic.Field(alias="pqEnabled")] = False
    r"""Use a disk queue to minimize data loss when connected services block. See [Cribl Docs](https://docs.cribl.io/stream/persistent-queues) for PQ defaults (Cribl-managed Cloud Workers) and configuration options (on-prem and hybrid Workers)."""

    streamtags: Optional[List[str]] = None
    r"""Tags for filtering and grouping in @{product}"""

    connections: Optional[List[ConnectionsType]] = None
    r"""Direct connections to Destinations, and optionally via a Pipeline or a Pack"""

    pq: Optional[PqType] = None

    read_mode: Annotated[
        Annotated[Optional[ReadMode6], PlainValidator(validate_open_enum(False))],
        pydantic.Field(alias="readMode"),
    ] = ReadMode6.NEWEST
    r"""Read all stored and future event logs, or only future events"""

    event_format: Annotated[
        Annotated[Optional[EventFormat6], PlainValidator(validate_open_enum(False))],
        pydantic.Field(alias="eventFormat"),
    ] = EventFormat6.JSON
    r"""Format of individual events"""

    interval: Optional[float] = 10
    r"""Time, in seconds, between checking for new entries (Applicable for pre-4.8.0 nodes that use Windows Tools)"""

    batch_size: Annotated[Optional[float], pydantic.Field(alias="batchSize")] = 500
    r"""The maximum number of events to read in one polling interval. A batch size higher than 500 can cause delays when pulling from multiple event logs. (Applicable for pre-4.8.0 nodes that use Windows Tools)"""

    metadata: Optional[List[Metadata1Type]] = None
    r"""Fields to add to events from this input"""

    max_event_bytes: Annotated[
        Optional[float], pydantic.Field(alias="maxEventBytes")
    ] = 51200
    r"""The maximum number of bytes in an event before it is flushed to the pipelines"""

    description: Optional[str] = None

    disable_json_rendering: Annotated[
        Optional[bool], pydantic.Field(alias="disableJsonRendering")
    ] = False
    r"""Enable/disable the rendering of localized event message strings (Applicable for 4.8.0 nodes and newer that use the Native API)"""

    disable_xml_rendering: Annotated[
        Optional[bool], pydantic.Field(alias="disableXmlRendering")
    ] = True
    r"""Enable/disable the rendering of localized event message strings (Applicable for 4.8.0 nodes and newer that use the Native API)"""

    @field_serializer("read_mode")
    def serialize_read_mode(self, value):
        if isinstance(value, str):
            try:
                return models.ReadMode6(value)
            except ValueError:
                return value
        return value

    @field_serializer("event_format")
    def serialize_event_format(self, value):
        if isinstance(value, str):
            try:
                return models.EventFormat6(value)
            except ValueError:
                return value
        return value


class InputWinEventLogsType5(str, Enum):
    WIN_EVENT_LOGS = "win_event_logs"


class ReadMode5(str, Enum, metaclass=utils.OpenEnumMeta):
    r"""Read all stored and future event logs, or only future events"""

    # Entire log
    OLDEST = "oldest"
    # From last entry
    NEWEST = "newest"


class EventFormat5(str, Enum, metaclass=utils.OpenEnumMeta):
    r"""Format of individual events"""

    # JSON
    JSON = "json"
    # XML
    XML = "xml"


class InputWinEventLogsWinEventLogs5TypedDict(TypedDict):
    type: InputWinEventLogsType5
    log_names: List[str]
    r"""Enter the event logs to collect. Run \"Get-WinEvent -ListLog *\" in PowerShell to see the available logs."""
    disable_native_module: NotRequired[bool]
    r"""Enable to use built-in tools (PowerShell for JSON, wevtutil for XML) to collect event logs instead of native API (default) [Learn more](https://docs.cribl.io/edge/sources-windows-event-logs/#advanced-settings)"""
    id: NotRequired[str]
    r"""Unique ID for this input"""
    disabled: NotRequired[bool]
    pipeline: NotRequired[str]
    r"""Pipeline to process data from this Source before sending it through the Routes"""
    send_to_routes: NotRequired[bool]
    r"""Select whether to send data to Routes, or directly to Destinations."""
    environment: NotRequired[str]
    r"""Optionally, enable this config only on a specified Git branch. If empty, will be enabled everywhere."""
    pq_enabled: NotRequired[bool]
    r"""Use a disk queue to minimize data loss when connected services block. See [Cribl Docs](https://docs.cribl.io/stream/persistent-queues) for PQ defaults (Cribl-managed Cloud Workers) and configuration options (on-prem and hybrid Workers)."""
    streamtags: NotRequired[List[str]]
    r"""Tags for filtering and grouping in @{product}"""
    connections: NotRequired[List[ConnectionsTypeTypedDict]]
    r"""Direct connections to Destinations, and optionally via a Pipeline or a Pack"""
    pq: NotRequired[PqTypeTypedDict]
    read_mode: NotRequired[ReadMode5]
    r"""Read all stored and future event logs, or only future events"""
    event_format: NotRequired[EventFormat5]
    r"""Format of individual events"""
    interval: NotRequired[float]
    r"""Time, in seconds, between checking for new entries (Applicable for pre-4.8.0 nodes that use Windows Tools)"""
    batch_size: NotRequired[float]
    r"""The maximum number of events to read in one polling interval. A batch size higher than 500 can cause delays when pulling from multiple event logs. (Applicable for pre-4.8.0 nodes that use Windows Tools)"""
    metadata: NotRequired[List[Metadata1TypeTypedDict]]
    r"""Fields to add to events from this input"""
    max_event_bytes: NotRequired[float]
    r"""The maximum number of bytes in an event before it is flushed to the pipelines"""
    description: NotRequired[str]
    disable_json_rendering: NotRequired[bool]
    r"""Enable/disable the rendering of localized event message strings (Applicable for 4.8.0 nodes and newer that use the Native API)"""
    disable_xml_rendering: NotRequired[bool]
    r"""Enable/disable the rendering of localized event message strings (Applicable for 4.8.0 nodes and newer that use the Native API)"""


class InputWinEventLogsWinEventLogs5(BaseModel):
    type: InputWinEventLogsType5

    log_names: Annotated[List[str], pydantic.Field(alias="logNames")]
    r"""Enter the event logs to collect. Run \"Get-WinEvent -ListLog *\" in PowerShell to see the available logs."""

    disable_native_module: Annotated[
        Optional[bool], pydantic.Field(alias="disableNativeModule")
    ] = False
    r"""Enable to use built-in tools (PowerShell for JSON, wevtutil for XML) to collect event logs instead of native API (default) [Learn more](https://docs.cribl.io/edge/sources-windows-event-logs/#advanced-settings)"""

    id: Optional[str] = None
    r"""Unique ID for this input"""

    disabled: Optional[bool] = False

    pipeline: Optional[str] = None
    r"""Pipeline to process data from this Source before sending it through the Routes"""

    send_to_routes: Annotated[Optional[bool], pydantic.Field(alias="sendToRoutes")] = (
        True
    )
    r"""Select whether to send data to Routes, or directly to Destinations."""

    environment: Optional[str] = None
    r"""Optionally, enable this config only on a specified Git branch. If empty, will be enabled everywhere."""

    pq_enabled: Annotated[Optional[bool], pydantic.Field(alias="pqEnabled")] = False
    r"""Use a disk queue to minimize data loss when connected services block. See [Cribl Docs](https://docs.cribl.io/stream/persistent-queues) for PQ defaults (Cribl-managed Cloud Workers) and configuration options (on-prem and hybrid Workers)."""

    streamtags: Optional[List[str]] = None
    r"""Tags for filtering and grouping in @{product}"""

    connections: Optional[List[ConnectionsType]] = None
    r"""Direct connections to Destinations, and optionally via a Pipeline or a Pack"""

    pq: Optional[PqType] = None

    read_mode: Annotated[
        Annotated[Optional[ReadMode5], PlainValidator(validate_open_enum(False))],
        pydantic.Field(alias="readMode"),
    ] = ReadMode5.NEWEST
    r"""Read all stored and future event logs, or only future events"""

    event_format: Annotated[
        Annotated[Optional[EventFormat5], PlainValidator(validate_open_enum(False))],
        pydantic.Field(alias="eventFormat"),
    ] = EventFormat5.JSON
    r"""Format of individual events"""

    interval: Optional[float] = 10
    r"""Time, in seconds, between checking for new entries (Applicable for pre-4.8.0 nodes that use Windows Tools)"""

    batch_size: Annotated[Optional[float], pydantic.Field(alias="batchSize")] = 500
    r"""The maximum number of events to read in one polling interval. A batch size higher than 500 can cause delays when pulling from multiple event logs. (Applicable for pre-4.8.0 nodes that use Windows Tools)"""

    metadata: Optional[List[Metadata1Type]] = None
    r"""Fields to add to events from this input"""

    max_event_bytes: Annotated[
        Optional[float], pydantic.Field(alias="maxEventBytes")
    ] = 51200
    r"""The maximum number of bytes in an event before it is flushed to the pipelines"""

    description: Optional[str] = None

    disable_json_rendering: Annotated[
        Optional[bool], pydantic.Field(alias="disableJsonRendering")
    ] = False
    r"""Enable/disable the rendering of localized event message strings (Applicable for 4.8.0 nodes and newer that use the Native API)"""

    disable_xml_rendering: Annotated[
        Optional[bool], pydantic.Field(alias="disableXmlRendering")
    ] = True
    r"""Enable/disable the rendering of localized event message strings (Applicable for 4.8.0 nodes and newer that use the Native API)"""

    @field_serializer("read_mode")
    def serialize_read_mode(self, value):
        if isinstance(value, str):
            try:
                return models.ReadMode5(value)
            except ValueError:
                return value
        return value

    @field_serializer("event_format")
    def serialize_event_format(self, value):
        if isinstance(value, str):
            try:
                return models.EventFormat5(value)
            except ValueError:
                return value
        return value


class InputWinEventLogsType4(str, Enum):
    WIN_EVENT_LOGS = "win_event_logs"


class ReadMode4(str, Enum, metaclass=utils.OpenEnumMeta):
    r"""Read all stored and future event logs, or only future events"""

    # Entire log
    OLDEST = "oldest"
    # From last entry
    NEWEST = "newest"


class EventFormat4(str, Enum, metaclass=utils.OpenEnumMeta):
    r"""Format of individual events"""

    # JSON
    JSON = "json"
    # XML
    XML = "xml"


class InputWinEventLogsWinEventLogs4TypedDict(TypedDict):
    type: InputWinEventLogsType4
    pq: PqTypeTypedDict
    log_names: List[str]
    r"""Enter the event logs to collect. Run \"Get-WinEvent -ListLog *\" in PowerShell to see the available logs."""
    pq_enabled: NotRequired[bool]
    r"""Use a disk queue to minimize data loss when connected services block. See [Cribl Docs](https://docs.cribl.io/stream/persistent-queues) for PQ defaults (Cribl-managed Cloud Workers) and configuration options (on-prem and hybrid Workers)."""
    id: NotRequired[str]
    r"""Unique ID for this input"""
    disabled: NotRequired[bool]
    pipeline: NotRequired[str]
    r"""Pipeline to process data from this Source before sending it through the Routes"""
    send_to_routes: NotRequired[bool]
    r"""Select whether to send data to Routes, or directly to Destinations."""
    environment: NotRequired[str]
    r"""Optionally, enable this config only on a specified Git branch. If empty, will be enabled everywhere."""
    streamtags: NotRequired[List[str]]
    r"""Tags for filtering and grouping in @{product}"""
    connections: NotRequired[List[ConnectionsTypeTypedDict]]
    r"""Direct connections to Destinations, and optionally via a Pipeline or a Pack"""
    read_mode: NotRequired[ReadMode4]
    r"""Read all stored and future event logs, or only future events"""
    event_format: NotRequired[EventFormat4]
    r"""Format of individual events"""
    disable_native_module: NotRequired[bool]
    r"""Enable to use built-in tools (PowerShell for JSON, wevtutil for XML) to collect event logs instead of native API (default) [Learn more](https://docs.cribl.io/edge/sources-windows-event-logs/#advanced-settings)"""
    interval: NotRequired[float]
    r"""Time, in seconds, between checking for new entries (Applicable for pre-4.8.0 nodes that use Windows Tools)"""
    batch_size: NotRequired[float]
    r"""The maximum number of events to read in one polling interval. A batch size higher than 500 can cause delays when pulling from multiple event logs. (Applicable for pre-4.8.0 nodes that use Windows Tools)"""
    metadata: NotRequired[List[Metadata1TypeTypedDict]]
    r"""Fields to add to events from this input"""
    max_event_bytes: NotRequired[float]
    r"""The maximum number of bytes in an event before it is flushed to the pipelines"""
    description: NotRequired[str]
    disable_json_rendering: NotRequired[bool]
    r"""Enable/disable the rendering of localized event message strings (Applicable for 4.8.0 nodes and newer that use the Native API)"""
    disable_xml_rendering: NotRequired[bool]
    r"""Enable/disable the rendering of localized event message strings (Applicable for 4.8.0 nodes and newer that use the Native API)"""


class InputWinEventLogsWinEventLogs4(BaseModel):
    type: InputWinEventLogsType4

    pq: PqType

    log_names: Annotated[List[str], pydantic.Field(alias="logNames")]
    r"""Enter the event logs to collect. Run \"Get-WinEvent -ListLog *\" in PowerShell to see the available logs."""

    pq_enabled: Annotated[Optional[bool], pydantic.Field(alias="pqEnabled")] = False
    r"""Use a disk queue to minimize data loss when connected services block. See [Cribl Docs](https://docs.cribl.io/stream/persistent-queues) for PQ defaults (Cribl-managed Cloud Workers) and configuration options (on-prem and hybrid Workers)."""

    id: Optional[str] = None
    r"""Unique ID for this input"""

    disabled: Optional[bool] = False

    pipeline: Optional[str] = None
    r"""Pipeline to process data from this Source before sending it through the Routes"""

    send_to_routes: Annotated[Optional[bool], pydantic.Field(alias="sendToRoutes")] = (
        True
    )
    r"""Select whether to send data to Routes, or directly to Destinations."""

    environment: Optional[str] = None
    r"""Optionally, enable this config only on a specified Git branch. If empty, will be enabled everywhere."""

    streamtags: Optional[List[str]] = None
    r"""Tags for filtering and grouping in @{product}"""

    connections: Optional[List[ConnectionsType]] = None
    r"""Direct connections to Destinations, and optionally via a Pipeline or a Pack"""

    read_mode: Annotated[
        Annotated[Optional[ReadMode4], PlainValidator(validate_open_enum(False))],
        pydantic.Field(alias="readMode"),
    ] = ReadMode4.NEWEST
    r"""Read all stored and future event logs, or only future events"""

    event_format: Annotated[
        Annotated[Optional[EventFormat4], PlainValidator(validate_open_enum(False))],
        pydantic.Field(alias="eventFormat"),
    ] = EventFormat4.JSON
    r"""Format of individual events"""

    disable_native_module: Annotated[
        Optional[bool], pydantic.Field(alias="disableNativeModule")
    ] = False
    r"""Enable to use built-in tools (PowerShell for JSON, wevtutil for XML) to collect event logs instead of native API (default) [Learn more](https://docs.cribl.io/edge/sources-windows-event-logs/#advanced-settings)"""

    interval: Optional[float] = 10
    r"""Time, in seconds, between checking for new entries (Applicable for pre-4.8.0 nodes that use Windows Tools)"""

    batch_size: Annotated[Optional[float], pydantic.Field(alias="batchSize")] = 500
    r"""The maximum number of events to read in one polling interval. A batch size higher than 500 can cause delays when pulling from multiple event logs. (Applicable for pre-4.8.0 nodes that use Windows Tools)"""

    metadata: Optional[List[Metadata1Type]] = None
    r"""Fields to add to events from this input"""

    max_event_bytes: Annotated[
        Optional[float], pydantic.Field(alias="maxEventBytes")
    ] = 51200
    r"""The maximum number of bytes in an event before it is flushed to the pipelines"""

    description: Optional[str] = None

    disable_json_rendering: Annotated[
        Optional[bool], pydantic.Field(alias="disableJsonRendering")
    ] = False
    r"""Enable/disable the rendering of localized event message strings (Applicable for 4.8.0 nodes and newer that use the Native API)"""

    disable_xml_rendering: Annotated[
        Optional[bool], pydantic.Field(alias="disableXmlRendering")
    ] = True
    r"""Enable/disable the rendering of localized event message strings (Applicable for 4.8.0 nodes and newer that use the Native API)"""

    @field_serializer("read_mode")
    def serialize_read_mode(self, value):
        if isinstance(value, str):
            try:
                return models.ReadMode4(value)
            except ValueError:
                return value
        return value

    @field_serializer("event_format")
    def serialize_event_format(self, value):
        if isinstance(value, str):
            try:
                return models.EventFormat4(value)
            except ValueError:
                return value
        return value


class InputWinEventLogsType3(str, Enum):
    WIN_EVENT_LOGS = "win_event_logs"


class ReadMode3(str, Enum, metaclass=utils.OpenEnumMeta):
    r"""Read all stored and future event logs, or only future events"""

    # Entire log
    OLDEST = "oldest"
    # From last entry
    NEWEST = "newest"


class EventFormat3(str, Enum, metaclass=utils.OpenEnumMeta):
    r"""Format of individual events"""

    # JSON
    JSON = "json"
    # XML
    XML = "xml"


class InputWinEventLogsWinEventLogs3TypedDict(TypedDict):
    type: InputWinEventLogsType3
    log_names: List[str]
    r"""Enter the event logs to collect. Run \"Get-WinEvent -ListLog *\" in PowerShell to see the available logs."""
    pq_enabled: NotRequired[bool]
    r"""Use a disk queue to minimize data loss when connected services block. See [Cribl Docs](https://docs.cribl.io/stream/persistent-queues) for PQ defaults (Cribl-managed Cloud Workers) and configuration options (on-prem and hybrid Workers)."""
    id: NotRequired[str]
    r"""Unique ID for this input"""
    disabled: NotRequired[bool]
    pipeline: NotRequired[str]
    r"""Pipeline to process data from this Source before sending it through the Routes"""
    send_to_routes: NotRequired[bool]
    r"""Select whether to send data to Routes, or directly to Destinations."""
    environment: NotRequired[str]
    r"""Optionally, enable this config only on a specified Git branch. If empty, will be enabled everywhere."""
    streamtags: NotRequired[List[str]]
    r"""Tags for filtering and grouping in @{product}"""
    connections: NotRequired[List[ConnectionsTypeTypedDict]]
    r"""Direct connections to Destinations, and optionally via a Pipeline or a Pack"""
    pq: NotRequired[PqTypeTypedDict]
    read_mode: NotRequired[ReadMode3]
    r"""Read all stored and future event logs, or only future events"""
    event_format: NotRequired[EventFormat3]
    r"""Format of individual events"""
    disable_native_module: NotRequired[bool]
    r"""Enable to use built-in tools (PowerShell for JSON, wevtutil for XML) to collect event logs instead of native API (default) [Learn more](https://docs.cribl.io/edge/sources-windows-event-logs/#advanced-settings)"""
    interval: NotRequired[float]
    r"""Time, in seconds, between checking for new entries (Applicable for pre-4.8.0 nodes that use Windows Tools)"""
    batch_size: NotRequired[float]
    r"""The maximum number of events to read in one polling interval. A batch size higher than 500 can cause delays when pulling from multiple event logs. (Applicable for pre-4.8.0 nodes that use Windows Tools)"""
    metadata: NotRequired[List[Metadata1TypeTypedDict]]
    r"""Fields to add to events from this input"""
    max_event_bytes: NotRequired[float]
    r"""The maximum number of bytes in an event before it is flushed to the pipelines"""
    description: NotRequired[str]
    disable_json_rendering: NotRequired[bool]
    r"""Enable/disable the rendering of localized event message strings (Applicable for 4.8.0 nodes and newer that use the Native API)"""
    disable_xml_rendering: NotRequired[bool]
    r"""Enable/disable the rendering of localized event message strings (Applicable for 4.8.0 nodes and newer that use the Native API)"""


class InputWinEventLogsWinEventLogs3(BaseModel):
    type: InputWinEventLogsType3

    log_names: Annotated[List[str], pydantic.Field(alias="logNames")]
    r"""Enter the event logs to collect. Run \"Get-WinEvent -ListLog *\" in PowerShell to see the available logs."""

    pq_enabled: Annotated[Optional[bool], pydantic.Field(alias="pqEnabled")] = False
    r"""Use a disk queue to minimize data loss when connected services block. See [Cribl Docs](https://docs.cribl.io/stream/persistent-queues) for PQ defaults (Cribl-managed Cloud Workers) and configuration options (on-prem and hybrid Workers)."""

    id: Optional[str] = None
    r"""Unique ID for this input"""

    disabled: Optional[bool] = False

    pipeline: Optional[str] = None
    r"""Pipeline to process data from this Source before sending it through the Routes"""

    send_to_routes: Annotated[Optional[bool], pydantic.Field(alias="sendToRoutes")] = (
        True
    )
    r"""Select whether to send data to Routes, or directly to Destinations."""

    environment: Optional[str] = None
    r"""Optionally, enable this config only on a specified Git branch. If empty, will be enabled everywhere."""

    streamtags: Optional[List[str]] = None
    r"""Tags for filtering and grouping in @{product}"""

    connections: Optional[List[ConnectionsType]] = None
    r"""Direct connections to Destinations, and optionally via a Pipeline or a Pack"""

    pq: Optional[PqType] = None

    read_mode: Annotated[
        Annotated[Optional[ReadMode3], PlainValidator(validate_open_enum(False))],
        pydantic.Field(alias="readMode"),
    ] = ReadMode3.NEWEST
    r"""Read all stored and future event logs, or only future events"""

    event_format: Annotated[
        Annotated[Optional[EventFormat3], PlainValidator(validate_open_enum(False))],
        pydantic.Field(alias="eventFormat"),
    ] = EventFormat3.JSON
    r"""Format of individual events"""

    disable_native_module: Annotated[
        Optional[bool], pydantic.Field(alias="disableNativeModule")
    ] = False
    r"""Enable to use built-in tools (PowerShell for JSON, wevtutil for XML) to collect event logs instead of native API (default) [Learn more](https://docs.cribl.io/edge/sources-windows-event-logs/#advanced-settings)"""

    interval: Optional[float] = 10
    r"""Time, in seconds, between checking for new entries (Applicable for pre-4.8.0 nodes that use Windows Tools)"""

    batch_size: Annotated[Optional[float], pydantic.Field(alias="batchSize")] = 500
    r"""The maximum number of events to read in one polling interval. A batch size higher than 500 can cause delays when pulling from multiple event logs. (Applicable for pre-4.8.0 nodes that use Windows Tools)"""

    metadata: Optional[List[Metadata1Type]] = None
    r"""Fields to add to events from this input"""

    max_event_bytes: Annotated[
        Optional[float], pydantic.Field(alias="maxEventBytes")
    ] = 51200
    r"""The maximum number of bytes in an event before it is flushed to the pipelines"""

    description: Optional[str] = None

    disable_json_rendering: Annotated[
        Optional[bool], pydantic.Field(alias="disableJsonRendering")
    ] = False
    r"""Enable/disable the rendering of localized event message strings (Applicable for 4.8.0 nodes and newer that use the Native API)"""

    disable_xml_rendering: Annotated[
        Optional[bool], pydantic.Field(alias="disableXmlRendering")
    ] = True
    r"""Enable/disable the rendering of localized event message strings (Applicable for 4.8.0 nodes and newer that use the Native API)"""

    @field_serializer("read_mode")
    def serialize_read_mode(self, value):
        if isinstance(value, str):
            try:
                return models.ReadMode3(value)
            except ValueError:
                return value
        return value

    @field_serializer("event_format")
    def serialize_event_format(self, value):
        if isinstance(value, str):
            try:
                return models.EventFormat3(value)
            except ValueError:
                return value
        return value


class InputWinEventLogsType2(str, Enum):
    WIN_EVENT_LOGS = "win_event_logs"


class ReadMode2(str, Enum, metaclass=utils.OpenEnumMeta):
    r"""Read all stored and future event logs, or only future events"""

    # Entire log
    OLDEST = "oldest"
    # From last entry
    NEWEST = "newest"


class EventFormat2(str, Enum, metaclass=utils.OpenEnumMeta):
    r"""Format of individual events"""

    # JSON
    JSON = "json"
    # XML
    XML = "xml"


class InputWinEventLogsWinEventLogs2TypedDict(TypedDict):
    type: InputWinEventLogsType2
    connections: List[ConnectionsTypeTypedDict]
    r"""Direct connections to Destinations, and optionally via a Pipeline or a Pack"""
    log_names: List[str]
    r"""Enter the event logs to collect. Run \"Get-WinEvent -ListLog *\" in PowerShell to see the available logs."""
    send_to_routes: NotRequired[bool]
    r"""Select whether to send data to Routes, or directly to Destinations."""
    id: NotRequired[str]
    r"""Unique ID for this input"""
    disabled: NotRequired[bool]
    pipeline: NotRequired[str]
    r"""Pipeline to process data from this Source before sending it through the Routes"""
    environment: NotRequired[str]
    r"""Optionally, enable this config only on a specified Git branch. If empty, will be enabled everywhere."""
    pq_enabled: NotRequired[bool]
    r"""Use a disk queue to minimize data loss when connected services block. See [Cribl Docs](https://docs.cribl.io/stream/persistent-queues) for PQ defaults (Cribl-managed Cloud Workers) and configuration options (on-prem and hybrid Workers)."""
    streamtags: NotRequired[List[str]]
    r"""Tags for filtering and grouping in @{product}"""
    pq: NotRequired[PqTypeTypedDict]
    read_mode: NotRequired[ReadMode2]
    r"""Read all stored and future event logs, or only future events"""
    event_format: NotRequired[EventFormat2]
    r"""Format of individual events"""
    disable_native_module: NotRequired[bool]
    r"""Enable to use built-in tools (PowerShell for JSON, wevtutil for XML) to collect event logs instead of native API (default) [Learn more](https://docs.cribl.io/edge/sources-windows-event-logs/#advanced-settings)"""
    interval: NotRequired[float]
    r"""Time, in seconds, between checking for new entries (Applicable for pre-4.8.0 nodes that use Windows Tools)"""
    batch_size: NotRequired[float]
    r"""The maximum number of events to read in one polling interval. A batch size higher than 500 can cause delays when pulling from multiple event logs. (Applicable for pre-4.8.0 nodes that use Windows Tools)"""
    metadata: NotRequired[List[Metadata1TypeTypedDict]]
    r"""Fields to add to events from this input"""
    max_event_bytes: NotRequired[float]
    r"""The maximum number of bytes in an event before it is flushed to the pipelines"""
    description: NotRequired[str]
    disable_json_rendering: NotRequired[bool]
    r"""Enable/disable the rendering of localized event message strings (Applicable for 4.8.0 nodes and newer that use the Native API)"""
    disable_xml_rendering: NotRequired[bool]
    r"""Enable/disable the rendering of localized event message strings (Applicable for 4.8.0 nodes and newer that use the Native API)"""


class InputWinEventLogsWinEventLogs2(BaseModel):
    type: InputWinEventLogsType2

    connections: List[ConnectionsType]
    r"""Direct connections to Destinations, and optionally via a Pipeline or a Pack"""

    log_names: Annotated[List[str], pydantic.Field(alias="logNames")]
    r"""Enter the event logs to collect. Run \"Get-WinEvent -ListLog *\" in PowerShell to see the available logs."""

    send_to_routes: Annotated[Optional[bool], pydantic.Field(alias="sendToRoutes")] = (
        True
    )
    r"""Select whether to send data to Routes, or directly to Destinations."""

    id: Optional[str] = None
    r"""Unique ID for this input"""

    disabled: Optional[bool] = False

    pipeline: Optional[str] = None
    r"""Pipeline to process data from this Source before sending it through the Routes"""

    environment: Optional[str] = None
    r"""Optionally, enable this config only on a specified Git branch. If empty, will be enabled everywhere."""

    pq_enabled: Annotated[Optional[bool], pydantic.Field(alias="pqEnabled")] = False
    r"""Use a disk queue to minimize data loss when connected services block. See [Cribl Docs](https://docs.cribl.io/stream/persistent-queues) for PQ defaults (Cribl-managed Cloud Workers) and configuration options (on-prem and hybrid Workers)."""

    streamtags: Optional[List[str]] = None
    r"""Tags for filtering and grouping in @{product}"""

    pq: Optional[PqType] = None

    read_mode: Annotated[
        Annotated[Optional[ReadMode2], PlainValidator(validate_open_enum(False))],
        pydantic.Field(alias="readMode"),
    ] = ReadMode2.NEWEST
    r"""Read all stored and future event logs, or only future events"""

    event_format: Annotated[
        Annotated[Optional[EventFormat2], PlainValidator(validate_open_enum(False))],
        pydantic.Field(alias="eventFormat"),
    ] = EventFormat2.JSON
    r"""Format of individual events"""

    disable_native_module: Annotated[
        Optional[bool], pydantic.Field(alias="disableNativeModule")
    ] = False
    r"""Enable to use built-in tools (PowerShell for JSON, wevtutil for XML) to collect event logs instead of native API (default) [Learn more](https://docs.cribl.io/edge/sources-windows-event-logs/#advanced-settings)"""

    interval: Optional[float] = 10
    r"""Time, in seconds, between checking for new entries (Applicable for pre-4.8.0 nodes that use Windows Tools)"""

    batch_size: Annotated[Optional[float], pydantic.Field(alias="batchSize")] = 500
    r"""The maximum number of events to read in one polling interval. A batch size higher than 500 can cause delays when pulling from multiple event logs. (Applicable for pre-4.8.0 nodes that use Windows Tools)"""

    metadata: Optional[List[Metadata1Type]] = None
    r"""Fields to add to events from this input"""

    max_event_bytes: Annotated[
        Optional[float], pydantic.Field(alias="maxEventBytes")
    ] = 51200
    r"""The maximum number of bytes in an event before it is flushed to the pipelines"""

    description: Optional[str] = None

    disable_json_rendering: Annotated[
        Optional[bool], pydantic.Field(alias="disableJsonRendering")
    ] = False
    r"""Enable/disable the rendering of localized event message strings (Applicable for 4.8.0 nodes and newer that use the Native API)"""

    disable_xml_rendering: Annotated[
        Optional[bool], pydantic.Field(alias="disableXmlRendering")
    ] = True
    r"""Enable/disable the rendering of localized event message strings (Applicable for 4.8.0 nodes and newer that use the Native API)"""

    @field_serializer("read_mode")
    def serialize_read_mode(self, value):
        if isinstance(value, str):
            try:
                return models.ReadMode2(value)
            except ValueError:
                return value
        return value

    @field_serializer("event_format")
    def serialize_event_format(self, value):
        if isinstance(value, str):
            try:
                return models.EventFormat2(value)
            except ValueError:
                return value
        return value


class InputWinEventLogsType1(str, Enum):
    WIN_EVENT_LOGS = "win_event_logs"


class ReadMode1(str, Enum, metaclass=utils.OpenEnumMeta):
    r"""Read all stored and future event logs, or only future events"""

    # Entire log
    OLDEST = "oldest"
    # From last entry
    NEWEST = "newest"


class EventFormat1(str, Enum, metaclass=utils.OpenEnumMeta):
    r"""Format of individual events"""

    # JSON
    JSON = "json"
    # XML
    XML = "xml"


class InputWinEventLogsWinEventLogs1TypedDict(TypedDict):
    type: InputWinEventLogsType1
    log_names: List[str]
    r"""Enter the event logs to collect. Run \"Get-WinEvent -ListLog *\" in PowerShell to see the available logs."""
    send_to_routes: NotRequired[bool]
    r"""Select whether to send data to Routes, or directly to Destinations."""
    id: NotRequired[str]
    r"""Unique ID for this input"""
    disabled: NotRequired[bool]
    pipeline: NotRequired[str]
    r"""Pipeline to process data from this Source before sending it through the Routes"""
    environment: NotRequired[str]
    r"""Optionally, enable this config only on a specified Git branch. If empty, will be enabled everywhere."""
    pq_enabled: NotRequired[bool]
    r"""Use a disk queue to minimize data loss when connected services block. See [Cribl Docs](https://docs.cribl.io/stream/persistent-queues) for PQ defaults (Cribl-managed Cloud Workers) and configuration options (on-prem and hybrid Workers)."""
    streamtags: NotRequired[List[str]]
    r"""Tags for filtering and grouping in @{product}"""
    connections: NotRequired[List[ConnectionsTypeTypedDict]]
    r"""Direct connections to Destinations, and optionally via a Pipeline or a Pack"""
    pq: NotRequired[PqTypeTypedDict]
    read_mode: NotRequired[ReadMode1]
    r"""Read all stored and future event logs, or only future events"""
    event_format: NotRequired[EventFormat1]
    r"""Format of individual events"""
    disable_native_module: NotRequired[bool]
    r"""Enable to use built-in tools (PowerShell for JSON, wevtutil for XML) to collect event logs instead of native API (default) [Learn more](https://docs.cribl.io/edge/sources-windows-event-logs/#advanced-settings)"""
    interval: NotRequired[float]
    r"""Time, in seconds, between checking for new entries (Applicable for pre-4.8.0 nodes that use Windows Tools)"""
    batch_size: NotRequired[float]
    r"""The maximum number of events to read in one polling interval. A batch size higher than 500 can cause delays when pulling from multiple event logs. (Applicable for pre-4.8.0 nodes that use Windows Tools)"""
    metadata: NotRequired[List[Metadata1TypeTypedDict]]
    r"""Fields to add to events from this input"""
    max_event_bytes: NotRequired[float]
    r"""The maximum number of bytes in an event before it is flushed to the pipelines"""
    description: NotRequired[str]
    disable_json_rendering: NotRequired[bool]
    r"""Enable/disable the rendering of localized event message strings (Applicable for 4.8.0 nodes and newer that use the Native API)"""
    disable_xml_rendering: NotRequired[bool]
    r"""Enable/disable the rendering of localized event message strings (Applicable for 4.8.0 nodes and newer that use the Native API)"""


class InputWinEventLogsWinEventLogs1(BaseModel):
    type: InputWinEventLogsType1

    log_names: Annotated[List[str], pydantic.Field(alias="logNames")]
    r"""Enter the event logs to collect. Run \"Get-WinEvent -ListLog *\" in PowerShell to see the available logs."""

    send_to_routes: Annotated[Optional[bool], pydantic.Field(alias="sendToRoutes")] = (
        True
    )
    r"""Select whether to send data to Routes, or directly to Destinations."""

    id: Optional[str] = None
    r"""Unique ID for this input"""

    disabled: Optional[bool] = False

    pipeline: Optional[str] = None
    r"""Pipeline to process data from this Source before sending it through the Routes"""

    environment: Optional[str] = None
    r"""Optionally, enable this config only on a specified Git branch. If empty, will be enabled everywhere."""

    pq_enabled: Annotated[Optional[bool], pydantic.Field(alias="pqEnabled")] = False
    r"""Use a disk queue to minimize data loss when connected services block. See [Cribl Docs](https://docs.cribl.io/stream/persistent-queues) for PQ defaults (Cribl-managed Cloud Workers) and configuration options (on-prem and hybrid Workers)."""

    streamtags: Optional[List[str]] = None
    r"""Tags for filtering and grouping in @{product}"""

    connections: Optional[List[ConnectionsType]] = None
    r"""Direct connections to Destinations, and optionally via a Pipeline or a Pack"""

    pq: Optional[PqType] = None

    read_mode: Annotated[
        Annotated[Optional[ReadMode1], PlainValidator(validate_open_enum(False))],
        pydantic.Field(alias="readMode"),
    ] = ReadMode1.NEWEST
    r"""Read all stored and future event logs, or only future events"""

    event_format: Annotated[
        Annotated[Optional[EventFormat1], PlainValidator(validate_open_enum(False))],
        pydantic.Field(alias="eventFormat"),
    ] = EventFormat1.JSON
    r"""Format of individual events"""

    disable_native_module: Annotated[
        Optional[bool], pydantic.Field(alias="disableNativeModule")
    ] = False
    r"""Enable to use built-in tools (PowerShell for JSON, wevtutil for XML) to collect event logs instead of native API (default) [Learn more](https://docs.cribl.io/edge/sources-windows-event-logs/#advanced-settings)"""

    interval: Optional[float] = 10
    r"""Time, in seconds, between checking for new entries (Applicable for pre-4.8.0 nodes that use Windows Tools)"""

    batch_size: Annotated[Optional[float], pydantic.Field(alias="batchSize")] = 500
    r"""The maximum number of events to read in one polling interval. A batch size higher than 500 can cause delays when pulling from multiple event logs. (Applicable for pre-4.8.0 nodes that use Windows Tools)"""

    metadata: Optional[List[Metadata1Type]] = None
    r"""Fields to add to events from this input"""

    max_event_bytes: Annotated[
        Optional[float], pydantic.Field(alias="maxEventBytes")
    ] = 51200
    r"""The maximum number of bytes in an event before it is flushed to the pipelines"""

    description: Optional[str] = None

    disable_json_rendering: Annotated[
        Optional[bool], pydantic.Field(alias="disableJsonRendering")
    ] = False
    r"""Enable/disable the rendering of localized event message strings (Applicable for 4.8.0 nodes and newer that use the Native API)"""

    disable_xml_rendering: Annotated[
        Optional[bool], pydantic.Field(alias="disableXmlRendering")
    ] = True
    r"""Enable/disable the rendering of localized event message strings (Applicable for 4.8.0 nodes and newer that use the Native API)"""

    @field_serializer("read_mode")
    def serialize_read_mode(self, value):
        if isinstance(value, str):
            try:
                return models.ReadMode1(value)
            except ValueError:
                return value
        return value

    @field_serializer("event_format")
    def serialize_event_format(self, value):
        if isinstance(value, str):
            try:
                return models.EventFormat1(value)
            except ValueError:
                return value
        return value


InputWinEventLogsTypedDict = TypeAliasType(
    "InputWinEventLogsTypedDict",
    Union[
        InputWinEventLogsWinEventLogs1TypedDict,
        InputWinEventLogsWinEventLogs2TypedDict,
        InputWinEventLogsWinEventLogs3TypedDict,
        InputWinEventLogsWinEventLogs4TypedDict,
        InputWinEventLogsWinEventLogs5TypedDict,
        InputWinEventLogsWinEventLogs6TypedDict,
    ],
)


InputWinEventLogs = TypeAliasType(
    "InputWinEventLogs",
    Union[
        InputWinEventLogsWinEventLogs1,
        InputWinEventLogsWinEventLogs2,
        InputWinEventLogsWinEventLogs3,
        InputWinEventLogsWinEventLogs4,
        InputWinEventLogsWinEventLogs5,
        InputWinEventLogsWinEventLogs6,
    ],
)
