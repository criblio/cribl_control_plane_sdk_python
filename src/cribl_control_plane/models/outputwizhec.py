"""Code generated by Speakeasy (https://speakeasy.com). DO NOT EDIT."""

from __future__ import annotations
from .authenticationmethodoptionsauthtokensitems import (
    AuthenticationMethodOptionsAuthTokensItems,
)
from .backpressurebehavioroptions import BackpressureBehaviorOptions
from .failedrequestloggingmodeoptions import FailedRequestLoggingModeOptions
from .itemstypeextrahttpheaders import (
    ItemsTypeExtraHTTPHeaders,
    ItemsTypeExtraHTTPHeadersTypedDict,
)
from .itemstyperesponseretrysettings import (
    ItemsTypeResponseRetrySettings,
    ItemsTypeResponseRetrySettingsTypedDict,
)
from .timeoutretrysettingstype import (
    TimeoutRetrySettingsType,
    TimeoutRetrySettingsTypeTypedDict,
)
from .tlssettingsclientsidetype1 import (
    TLSSettingsClientSideType1,
    TLSSettingsClientSideType1TypedDict,
)
from cribl_control_plane import models
from cribl_control_plane.types import BaseModel
from enum import Enum
import pydantic
from pydantic import field_serializer
from typing import Any, List, Optional
from typing_extensions import Annotated, NotRequired, TypedDict


class OutputWizHecType(str, Enum):
    WIZ_HEC = "wiz_hec"


class OutputWizHecTypedDict(TypedDict):
    type: OutputWizHecType
    wiz_connector_id: str
    r"""The unique identifier for the specific Cribl connector defined in your Wiz Settings. This is used to cross-validate the bearer token and ensure traffic is originating from the authorized integration."""
    wiz_environment: str
    r"""Your Wiz deployment environment."""
    data_center: str
    r"""Your Wiz deployment data center (e.g., us1, us8, eu1). From Tenant Info → Data Center and Regions → Tenant Data Center in your Wiz console."""
    wiz_sourcetype: str
    id: NotRequired[str]
    r"""Unique ID for this output"""
    pipeline: NotRequired[str]
    r"""Pipeline to process data before sending out to this output"""
    system_fields: NotRequired[List[str]]
    r"""Fields to automatically add to events, such as cribl_pipe. Supports wildcards."""
    environment: NotRequired[str]
    r"""Optionally, enable this config only on a specified Git branch. If empty, will be enabled everywhere."""
    streamtags: NotRequired[List[str]]
    r"""Tags for filtering and grouping in @{product}"""
    load_balanced: NotRequired[Any]
    next_queue: NotRequired[str]
    r"""In the Splunk app, define which Splunk processing queue to send the events after HEC processing."""
    tcp_routing: NotRequired[str]
    r"""In the Splunk app, set the value of _TCP_ROUTING for events that do not have _ctrl._TCP_ROUTING set."""
    tls: NotRequired[TLSSettingsClientSideType1TypedDict]
    concurrency: NotRequired[float]
    r"""Maximum number of ongoing requests before blocking"""
    max_payload_size_kb: NotRequired[float]
    r"""Maximum size, in KB, of the request body"""
    max_payload_events: NotRequired[float]
    r"""Maximum number of events to include in the request body. Default is 0 (unlimited)."""
    compress: NotRequired[bool]
    r"""Compress the payload body before sending"""
    reject_unauthorized: NotRequired[bool]
    r"""Reject certificates not authorized by a CA in the CA certificate path or by another trusted CA (such as the system's).
    Enabled by default. When this setting is also present in TLS Settings (Client Side),
    that value will take precedence.
    """
    timeout_sec: NotRequired[float]
    r"""Amount of time, in seconds, to wait for a request to complete before canceling it"""
    flush_period_sec: NotRequired[float]
    r"""Maximum time between requests. Small values could cause the payload size to be smaller than the configured Body size limit."""
    extra_http_headers: NotRequired[List[ItemsTypeExtraHTTPHeadersTypedDict]]
    r"""Headers to add to all events"""
    failed_request_logging_mode: NotRequired[FailedRequestLoggingModeOptions]
    r"""Data to log when a request fails. All headers are redacted by default, unless listed as safe headers below."""
    safe_headers: NotRequired[List[str]]
    r"""List of headers that are safe to log in plain text"""
    enable_multi_metrics: NotRequired[Any]
    auth_type: NotRequired[AuthenticationMethodOptionsAuthTokensItems]
    r"""Select Manual to enter an auth token directly, or select Secret to use a text secret to authenticate"""
    response_retry_settings: NotRequired[List[ItemsTypeResponseRetrySettingsTypedDict]]
    r"""Automatically retry after unsuccessful response status codes, such as 429 (Too Many Requests) or 503 (Service Unavailable)"""
    timeout_retry_settings: NotRequired[TimeoutRetrySettingsTypeTypedDict]
    response_honor_retry_after_header: NotRequired[bool]
    r"""Honor any Retry-After header that specifies a delay (in seconds) no longer than 180 seconds after the retry request. @{product} limits the delay to 180 seconds, even if the Retry-After header specifies a longer delay. When enabled, takes precedence over user-configured retry options. When disabled, all Retry-After headers are ignored."""
    on_backpressure: NotRequired[BackpressureBehaviorOptions]
    r"""How to handle events when all receivers are exerting backpressure"""
    description: NotRequired[str]
    token: NotRequired[str]
    r"""Wiz Defender Auth token"""
    text_secret: NotRequired[str]
    r"""Select or create a stored text secret"""
    template_wiz_environment: NotRequired[str]
    r"""Binds 'wiz_environment' to a variable for dynamic value resolution. Set to variable ID (pack-scoped) or 'cribl.'/'edge.' prefixed ID (group-scoped). Variable value overrides 'wiz_environment' at runtime."""
    template_data_center: NotRequired[str]
    r"""Binds 'data_center' to a variable for dynamic value resolution. Set to variable ID (pack-scoped) or 'cribl.'/'edge.' prefixed ID (group-scoped). Variable value overrides 'data_center' at runtime."""
    template_wiz_sourcetype: NotRequired[str]
    r"""Binds 'wiz_sourcetype' to a variable for dynamic value resolution. Set to variable ID (pack-scoped) or 'cribl.'/'edge.' prefixed ID (group-scoped). Variable value overrides 'wiz_sourcetype' at runtime."""


class OutputWizHec(BaseModel):
    type: OutputWizHecType

    wiz_connector_id: str
    r"""The unique identifier for the specific Cribl connector defined in your Wiz Settings. This is used to cross-validate the bearer token and ensure traffic is originating from the authorized integration."""

    wiz_environment: str
    r"""Your Wiz deployment environment."""

    data_center: str
    r"""Your Wiz deployment data center (e.g., us1, us8, eu1). From Tenant Info → Data Center and Regions → Tenant Data Center in your Wiz console."""

    wiz_sourcetype: str

    id: Optional[str] = None
    r"""Unique ID for this output"""

    pipeline: Optional[str] = None
    r"""Pipeline to process data before sending out to this output"""

    system_fields: Annotated[
        Optional[List[str]], pydantic.Field(alias="systemFields")
    ] = None
    r"""Fields to automatically add to events, such as cribl_pipe. Supports wildcards."""

    environment: Optional[str] = None
    r"""Optionally, enable this config only on a specified Git branch. If empty, will be enabled everywhere."""

    streamtags: Optional[List[str]] = None
    r"""Tags for filtering and grouping in @{product}"""

    load_balanced: Annotated[Optional[Any], pydantic.Field(alias="loadBalanced")] = None

    next_queue: Annotated[Optional[str], pydantic.Field(alias="nextQueue")] = None
    r"""In the Splunk app, define which Splunk processing queue to send the events after HEC processing."""

    tcp_routing: Annotated[Optional[str], pydantic.Field(alias="tcpRouting")] = None
    r"""In the Splunk app, set the value of _TCP_ROUTING for events that do not have _ctrl._TCP_ROUTING set."""

    tls: Optional[TLSSettingsClientSideType1] = None

    concurrency: Optional[float] = None
    r"""Maximum number of ongoing requests before blocking"""

    max_payload_size_kb: Annotated[
        Optional[float], pydantic.Field(alias="maxPayloadSizeKB")
    ] = None
    r"""Maximum size, in KB, of the request body"""

    max_payload_events: Annotated[
        Optional[float], pydantic.Field(alias="maxPayloadEvents")
    ] = None
    r"""Maximum number of events to include in the request body. Default is 0 (unlimited)."""

    compress: Optional[bool] = None
    r"""Compress the payload body before sending"""

    reject_unauthorized: Annotated[
        Optional[bool], pydantic.Field(alias="rejectUnauthorized")
    ] = None
    r"""Reject certificates not authorized by a CA in the CA certificate path or by another trusted CA (such as the system's).
    Enabled by default. When this setting is also present in TLS Settings (Client Side),
    that value will take precedence.
    """

    timeout_sec: Annotated[Optional[float], pydantic.Field(alias="timeoutSec")] = None
    r"""Amount of time, in seconds, to wait for a request to complete before canceling it"""

    flush_period_sec: Annotated[
        Optional[float], pydantic.Field(alias="flushPeriodSec")
    ] = None
    r"""Maximum time between requests. Small values could cause the payload size to be smaller than the configured Body size limit."""

    extra_http_headers: Annotated[
        Optional[List[ItemsTypeExtraHTTPHeaders]],
        pydantic.Field(alias="extraHttpHeaders"),
    ] = None
    r"""Headers to add to all events"""

    failed_request_logging_mode: Annotated[
        Optional[FailedRequestLoggingModeOptions],
        pydantic.Field(alias="failedRequestLoggingMode"),
    ] = None
    r"""Data to log when a request fails. All headers are redacted by default, unless listed as safe headers below."""

    safe_headers: Annotated[
        Optional[List[str]], pydantic.Field(alias="safeHeaders")
    ] = None
    r"""List of headers that are safe to log in plain text"""

    enable_multi_metrics: Annotated[
        Optional[Any], pydantic.Field(alias="enableMultiMetrics")
    ] = None

    auth_type: Annotated[
        Optional[AuthenticationMethodOptionsAuthTokensItems],
        pydantic.Field(alias="authType"),
    ] = None
    r"""Select Manual to enter an auth token directly, or select Secret to use a text secret to authenticate"""

    response_retry_settings: Annotated[
        Optional[List[ItemsTypeResponseRetrySettings]],
        pydantic.Field(alias="responseRetrySettings"),
    ] = None
    r"""Automatically retry after unsuccessful response status codes, such as 429 (Too Many Requests) or 503 (Service Unavailable)"""

    timeout_retry_settings: Annotated[
        Optional[TimeoutRetrySettingsType], pydantic.Field(alias="timeoutRetrySettings")
    ] = None

    response_honor_retry_after_header: Annotated[
        Optional[bool], pydantic.Field(alias="responseHonorRetryAfterHeader")
    ] = None
    r"""Honor any Retry-After header that specifies a delay (in seconds) no longer than 180 seconds after the retry request. @{product} limits the delay to 180 seconds, even if the Retry-After header specifies a longer delay. When enabled, takes precedence over user-configured retry options. When disabled, all Retry-After headers are ignored."""

    on_backpressure: Annotated[
        Optional[BackpressureBehaviorOptions], pydantic.Field(alias="onBackpressure")
    ] = None
    r"""How to handle events when all receivers are exerting backpressure"""

    description: Optional[str] = None

    token: Optional[str] = None
    r"""Wiz Defender Auth token"""

    text_secret: Annotated[Optional[str], pydantic.Field(alias="textSecret")] = None
    r"""Select or create a stored text secret"""

    template_wiz_environment: Annotated[
        Optional[str], pydantic.Field(alias="__template_wiz_environment")
    ] = None
    r"""Binds 'wiz_environment' to a variable for dynamic value resolution. Set to variable ID (pack-scoped) or 'cribl.'/'edge.' prefixed ID (group-scoped). Variable value overrides 'wiz_environment' at runtime."""

    template_data_center: Annotated[
        Optional[str], pydantic.Field(alias="__template_data_center")
    ] = None
    r"""Binds 'data_center' to a variable for dynamic value resolution. Set to variable ID (pack-scoped) or 'cribl.'/'edge.' prefixed ID (group-scoped). Variable value overrides 'data_center' at runtime."""

    template_wiz_sourcetype: Annotated[
        Optional[str], pydantic.Field(alias="__template_wiz_sourcetype")
    ] = None
    r"""Binds 'wiz_sourcetype' to a variable for dynamic value resolution. Set to variable ID (pack-scoped) or 'cribl.'/'edge.' prefixed ID (group-scoped). Variable value overrides 'wiz_sourcetype' at runtime."""

    @field_serializer("failed_request_logging_mode")
    def serialize_failed_request_logging_mode(self, value):
        if isinstance(value, str):
            try:
                return models.FailedRequestLoggingModeOptions(value)
            except ValueError:
                return value
        return value

    @field_serializer("auth_type")
    def serialize_auth_type(self, value):
        if isinstance(value, str):
            try:
                return models.AuthenticationMethodOptionsAuthTokensItems(value)
            except ValueError:
                return value
        return value

    @field_serializer("on_backpressure")
    def serialize_on_backpressure(self, value):
        if isinstance(value, str):
            try:
                return models.BackpressureBehaviorOptions(value)
            except ValueError:
                return value
        return value
